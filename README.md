This is a Python ETL package built around the synergy between Data Model Code Generator,  Pydantic and Spark, intended for use with Microsoft Fabric's managed Spark runtime environment.  The general idea is to leverage automated model generation, be it from common data model  JSON schemas from Business Central, OpenAPI specification compliant schemas, such as those  from PSA, or just general JSON structured responses, such as those from Jira.  

The process roughly goes like this.  The first thing you do is use the code generator and one form of input to it or another to  automatically generate valid pydantic models that accurately describe the structure of  your data.  This is what forms the backbone of your bronze layer, regardless of whether it's PSA, Jira,  Business Central, or something entirely different, it doesn't matter.  Once you have those, you can use SparkDantic to create Spark schemas for data frames that  can be written directly to Delta tables using the managed Spark environment in Microsoft  Fabric.  This is obviously extremely convenient.  

This gives you automatic data validation, automatic schema evolution, built-in integrations  for observability, error handling, all sorts of convenient Python features, and generally  makes your data model easier to reason about. This package implements the medallion architecture in Microsoft Fabric, and currently it does  so for two distinct integrations, namely that of PSA and Business Central, but it does so  in differing ways for each source. In both cases, we simply land the raw data from the source in bronze.  Silver is for data validation and cleanup, removing prefixes, suffixes, generally standardizing  and conforming the data to our expectations.The gold layer is for augmenting and enriching the data, which means doing such things as  adding surrogate keys, creating dimension bridge tables, account hierarchies, creating foreign key relationships where appropriate, and importantly, it does not involve removing  or pruning any columns, changing their names, or anything like that.  Any such transformations, such as pruning column selection or altering names, is something  that happens in materialized views constructed on top of the gold layer, because those are  much easier to adjust on the fly.

Unfortunately, right now, it's kind of a mess.  There is way too much code duplication, there's confusion of responsibilities, there's mixing  of snake and camel case, which is very inappropriate, there's removal of columns that shouldn't  be there, and all sorts of other problems.  That's what I need you to fix.

